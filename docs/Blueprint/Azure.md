| Blueprint name          | Azure                                                                        |
| ----------------------- | ---------------------------------------------------------------------------- |
| Description             | Extractor for AzureÂ  will be built using this blueprint document.            |
| Creation date | 11 Feb 2021                                                                  |
| Version                  | 0.1                                                                      |
| Review Chanes            | -  |

**Stream- AZURE**

|   Dnif fields     | Azure fields   | Description                                                                                                                       |
| ----------------- | -------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| SystemTstamp      | eventTimestamp | Timestamp when the event was generated by the Azure service processing the request corresponding to the event.                    |
| EventName         | eventName      | Friendly name of the Administrative event.                                                                                        |
| Category          | category       | Sign in, audit, administrative                                                                                                    |
| User              | caller         | Email address of the user who has performed the operation, UPN claim, or SPN claim based on availability.                         |
| ResourceGroupName | resourceGroup  | Name of the resource group for the impacted resource.                                                                             |
| OperationName     | operationName  | Name of the operation.                                                                                                            |
| Status            | status         | String describing the status of the operation. Some common values are: Started, In Progress, Succeeded, Failed, Active, Resolved. |

**Number of Streams - 3**

Stream 1 - IAM

1. User - User Name of the user
2. Action - Action taken by an admin user for accounts / policies
3. Role- Details regarding role name for role updation or modification events
4. TargetUser - Target account on which changes are being made
5. Status - status of the action taken

Stream 2 - AUTHENTICATION

1. User - User trying to login
2. SrcIP - Client IP
3. Action -User Logged On, Logon Authentication Failed(Events)
4. AuthProto - Authentication protocol
5. Reason - Reason for auth failure actions
6. Status - Response of the action, passed or failed
7. System - authenticating server/Host

Stream 3 - CONFIGURATION

1. User - User who made changes
2. Action - Action taken
3. Config - Configuration name
4. Status - status of the action taken

**Requirement Gathering and Analysis -**

**Useful Links:**

https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/reference-azure-monitor-audit-log-schema

https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/reference-azure-monitor-sign-ins-log-schema

https://docs.microsoft.com/en-us/azure/azure-monitor/platform/activity-log-schema

https://docs.microsoft.com/en-us/azure/azure-monitor/platform/resource-logs-schema 
