schema-version: 1.0
#extractor-version: 1
extractor-id: 225
integration: Syslog(KV)
vendor-name: Arcon
product-name: Arcos
source-name: ARCOS
source-type: PIM
source-description: Extractor for Arcos PIM Events
provides-streams:
- AUTHENTICATION
master-filters:
- '^(?:\<\d+\>)?\{UserName\:\s+\S+\,.*?Status\:'  
- \{\'ID\'\:\s+\d+\,\s+\'EventID\'\:\s+\d+\,.*?\'Status\'
event-details:  
- first-match: \s+\'?Status\'?\:\s+\'?Authentication\s+Failed\'?\,
  decoder: custom
  decoder-regex: \'?(\w+)\'?\:\s+\'?([^\'\,\}]+)\'?
  event-key-format: ''
  event-key-mapping:
    '': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_CREDENTAILS
      translate: 
        UserName: User
        SrcIP: SrcIP
        AuthProto: AuthProto

  fallback:
    annotate:
      EventName: Generic Arcos PIM Event
      Stream: OTHER

  globals:
    translate:
      EventTimeStamp: SystemTstamp
      System: System      

- first-match: \'?UserSessionLoginTimeStamp\'?\:\s+[\'\w\/\s\:]+\,\s+\'?UserSessionLogoutTimeStamp\'?\:\s+[\'\w\/\s\:]+\,\s+\'?Status\'?\:\s\'?Success\'\,
  decoder: custom
  decoder-regex: \'?(\w+)\'?\:\s+\'?([^\'\,\}]+)\'?
  event-key-format: ''
  event-key-mapping:        
    '':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED        
      translate: 
        UserName: User
        SrcIP: SrcIP
        AuthProto: AuthProto    
    
  fallback:
    annotate:
      EventName: Generic Arcos PIM Event
      Stream: OTHER

  globals:
    translate:
      EventTimeStamp: SystemTstamp
      System: System

- first-match: \'?UserSessionLogoutTimeStamp\'?\:.*?\'?Status\'?\:\s+\w+\,.*?\'?UserSessionLoginTimeStamp\'?
  decoder: custom
  decoder-regex: \'?(\w+)\'?\:\s+\'?([^\'\,\}]+)\'?
  event-key-format: '{Status}'
  event-key-mapping:        
    'Success':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED        
      translate: 
        UserName: User
        SrcIP: SrcIP
        AuthProto: AuthProto    
    
  fallback:
    annotate:
      EventName: Generic Arcos PIM Event
      Stream: OTHER

  globals:
    translate:
      EventTimeStamp: SystemTstamp
      System: System