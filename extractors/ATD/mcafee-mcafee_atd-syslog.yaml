schema-version: 1.0
#extractor-version: 1
extractor-id: 192
source-name: MCAFEE
source-type: ATD
source-description: Extractor for McAfee ATD Events
provides-streams:
- AUTHENTICATION
master-filters:
- '\w+\s+\d+\s+\d+\:\d+\:\d+\s+.*?(?:ATD2ESM|MATD\-LOG)\[\d+\]\:'
event-details:
- first-match: \"Action\"\:\s?\".*?\"\,
  decoder: custom
  decoder-regex: '\"([^\"]+)\"\:\s?\"([^\"]+)\"'
  event-key-format: '{Result}-{Action}'
  event-key-mapping:
    'Success-Session Login':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
        AuthMethod: '-'
        Reason: '-'
      translate:
        User: User
        Client: SrcIP
    'None-Successful user login':  
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
        AuthMethod: '-'
        Reason: '-'
      translate:
        User: User
        Client: SrcIP
    'None-Successful user logout': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED
        AuthMethod: '-'
        Reason: '-'
      translate:
        User: User
        Client: SrcIP  
    'Success-Session Logout':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED
        AuthMethod: '-'
        Reason: '-'
      translate:
        User: User
        Client: SrcIP 
    'None-Invalid user entered':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        AuthMethod: '-'
        Reason: INVALID_USER
      translate:
        User: User
        Client: SrcIP
    'None-Invalid User':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        AuthMethod: '-'
        Reason: INVALID_USER
      translate:
        User: User
        Client: SrcIP 
    'None-Invalid user name':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        AuthMethod: '-'
        Reason: INVALID_USER
      translate:
        User: User
        Client: SrcIP                

  fallback:
    annotate:
      EventName: Generic McAfee ATD Event
      Stream: OTHER

  globals:
    translate:
      Timestamp: SystemTstamp