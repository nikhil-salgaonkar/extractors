schema-version: 1.0
#extractor-version: 1
extractor-id: 247
integration: Syslog(LEEF)
vendor-name: ForeScout
product-name: CounterACT
source-name: FORESCOUT
source-type: NAC
source-description: Extractor for Forescout NAC Events
provides-streams:
- AUTHENTICATION
- IAM
master-filters:
- 'LEEF\:[\d\.]+\|ForeScout\|CounterACT\|'  
event-details:
- first-match: 'LEEF\:[\d\.]+\|ForeScout\|CounterACT\|[\d\.\-]+\|'
  decoder: custom
  decoder-regex: '(\w+)\=([^\s]*)|([^\s\|]+)'
  event-key-format: '{Header-4}'
  event-key-mapping: 
    'agent_auth_issuer':  
      annotate: 
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate:
        usrName: User
        src: SrcIP
        AuthProto: AuthProto

    'cached_credentials':  
      annotate:
        Stream: IAM
        Action: CACHED_CREDENTIALS
        Status: PASSED 
      translate:
        usrName: User
        Role: Role
        TargetUser: TargetUser

  fallback:
    annotate:
      EventName: Generic Forescout NAC Event
      Stream: OTHER

  globals:
    translate:
      System: System
      devTime: SystemTstamp