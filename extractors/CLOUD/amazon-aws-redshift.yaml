schema-version: 1.0
#extractor-version: 1
extractor-id: 728
integration: AWS S3
vendor-name: Amazon
product-name: Redshift
source-name: AMAZON-REDSHIFT
source-type: CLOUD
source-description: Extractor for Amazon Redshift Events
provides-streams:
- AUTHENTICATION
master-filters:
- '(?:authenticated|authentication\s+failure|initiating\s+session|disconnecting\s+session|set\s+application\_name)\s*\|\w{3}\,\s+\d{1,2}\s+\w{3}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2}\:\d+\|[\w\:\.\s]*\|[\d\s]*\|[\d\s]*\|[\w\s]*\|\S+\s*\|[\w\s]*\|'
- '\d{4}\-\d{1,2}\-\d{2}T\d{2}\:\d{2}\:\d{2}Z\s+UTC\s+\[\s*db\=[\w\s]*user=[\w\s]*pid\=[\d\s]*userid\=[\d\s]*xid\=[\d\s]*\].*?LOG\:'
event-details:
- first-match: '(?:authenticated|authentication\s+failure|initiating\s+session|disconnecting\s+session)'
  decoder: regex
  decoder-regex: '(?P<action>.*?)\s*\|(?P<datetime>\w{3}\,\s+\d{1,2}\s+\w{3}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})\:\d+\|[\w\:]+\:(?P<src>[\d\.]+)\s*\|[\d\s]*\|[\d\s]*\|[\w\s]*\|(?P<user>.*?)\s*\|(?P<authproto>\w+)\s*\|'
  event-key-format: '{action}'      
  event-key-mapping:
    'authenticated':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate: 
        user: User
        authproto: AuthProto
        src: SrcIP
    'authentication failure':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_CREDENTIALS
      translate: 
        user: User
        authproto: AuthProto
        src: SrcIP
    'initiating session':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate: 
        user: User
        authproto: AuthProto
        src: SrcIP
    'disconnecting session':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_CREDENTIALS
      translate: 
        user: User
        authproto: AuthProto
        src: SrcIP

  fallback:
    annotate:
      EventName: Generic Amazon Redshift Event
      Stream: OTHER  

  globals:
    translate:
      datetime: SystemTstamp
      System: System     