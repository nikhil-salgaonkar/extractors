schema-version: 1.0
#extractor-version: 1
extractor-id: 161
source-name: MIMECAST
source-type: EMAIL-GATEWAY
source-description: extractor for Mimecast Events
provides-streams:
- EMAIL-GATEWAY
- AUTHENTICATION
- THREAT
- IAM
master-filters:
- '(?:datetime|date)\=\d{4}\-\d{2}\-\d{2}T\d{2}\:\d{2}\:\d{2}\+\d+\|(?:mcType|aCode|acc)'
event-details:
- first-match: '(?:datetime|date)\=\d{4}\-\d{2}\-\d{2}T\d{2}\:\d{2}\:\d{2}\+\d+\|(?:mcType|aCode|acc)\='
  decoder: custom
  decoder-regex: (\w+)\=([^|]+)
  event-key-format: '{action}-{auditType}-{Delivered}-{Act}-{UrlCategory}-{reason}-{TaggedExternal}-{fileExt}'
  event-key-mapping:
    'failure-Logon Authentication Failed-None-None-None-None-None-None':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        AuthProto: '-'
      translate:
        src: SrcIP
        user: User
        eventInfo: Reason
    'success-User Logged On-None-None-None-None-None-None':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
        AuthProto: '-'
      translate:
        src: SrcIP
        user: User
        eventInfo: Reason
    'None-Account Updated-None-None-None-None-None-None':
      annotate:
        Stream: IAM
        Action: USER_ACCOUNT_UPDATED
        Status: PASSED
      translate:
        Rolename: Role
        TargetUser: TargetUser
        user: User
    'None-New Policy-None-None-None-None-None-None':
      annotate:
        Stream: IAM
        Action: POLICY_CREATED
        Status: PASSED
      translate:
        Rolename: Role
        TargetUser: TargetUser
        user: User
    'None-Policy Deleted-None-None-None-None-None-None':
      annotate:
        Stream: IAM
        Action: POLICY_DELETED
        Status: PASSED
      translate:
        Rolename: Role
        TargetUser: TargetUser
        user: User 
    'None-Existing User Role Updated-None-None-None-None-None-None':
      annotate:
        Stream: IAM
        Action: USER_ROLE_UPDATED
        Status: PASSED
        User: '-'
      translate:
        TargetUser: TargetUser      
        Rolename: Role
    'None-User removed from role-None-None-None-None-None-None':
      annotate:
        Stream: IAM
        Action: USER_REMOVED
        Status: PASSED
      translate:    
        TargetUser: TargetUser 
        Rolename: Role  
        user: User 
    'None-User added from role-None-None-None-None-None-None':
      annotate:
        Stream: IAM
        Action: USER_ADDED
        Status: PASSED
      translate:
        TargetUser: TargetUser       
        Rolename: Role
        user: User
    'None-User Password Changed-None-None-None-None-None-None':
      annotate:
        Stream: IAM
        Action: ACCOUNT_PASSWORD_RESET
        Status: PASSED
      translate:
        TargetUser: TargetUser       
        Rolename: Role
        user: User 
    'None-None-true-None-None-None-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_DELIVERED
      translate:
        IP: RemoteIP
        Dir: Direction
        Subject: Subject
        Sender: Sender
        Rcpt: Recipient
        AttNames: File
    'None-None-None-Acc-None-None-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_ACCEPTED
      translate:
        IP: RemoteIP
        Dir: Direction
        Subject: Subject
        Sender: Sender
        Rcpt: Recipient
        AttNames: File
    'None-None-None-Rej-None-None-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_REJECTED
      translate:
        IP: RemoteIP
        Dir: Direction
        Subject: Subject
        Sender: Sender
        Rcpt: Recipient
        AttNames: File
    'None-None-false-None-None-None-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_DELIVERED
        Status: FAILED
      translate:
        IP: RemoteIP
        Dir: Direction
        Subject: Subject
        Sender: Sender
        Rcpt: Recipient
        AttNames: File  
    'None-None-None-Bnc-None-None-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_BOUNCED
      translate:
        IP: RemoteIP
        Dir: Direction
        Subject: Subject
        Sender: Sender
        Rcpt: Recipient
        AttNames: File
    'None-None-None-Hld-None-None-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_HOLD
      translate:
        IP: RemoteIP
        Dir: Direction
        Subject: Subject
        Sender: Sender
        Rcpt: Recipient
        AttNames: File
    'None-None-None-None-None-malicious-None-None':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: EMAIL
      translate:
        sourceIp: SrcIP
        Sender: Sender
        recipient: Recipient
        Definition: Threat
    'None-None-None-None-Phishing & Fraud-None-None-None':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: EMAIL
      translate:
        sourceIp: SrcIP
        Sender: Sender
        Recipient: Recipient
        Definition: Threat
    'None-None-None-None-None-None-true-None':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: EMAIL
      translate:
        IP: SrcIP
        Sender: Sender
        Recipient: Recipient
        Definition: Threat   
    'None-None-None-None-None-None-None-pptx':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: EMAIL
      translate:
        IP: SrcIP
        Sender: Sender
        Recipient: Recipient
        Definition: Threat 
    'None-None-None-None-None-None-None-img':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: EMAIL
      translate:
        IP: SrcIP
        Sender: Sender
        Recipient: Recipient
        Definition: Threat                                   

  fallback:
    annotate:
      EventName: Generic Mimecast Event
      Stream: OTHER

  globals:
    annotate:
      System: Mimecast
    translate:
      date: SystemTstamp
      datetime: SystemTstamp