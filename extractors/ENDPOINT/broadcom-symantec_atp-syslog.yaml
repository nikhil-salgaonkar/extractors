schema-version: 1.0
#extractor-version: 1
extractor-id: 94
source-name: SYMANTEC_ATP
source-type: ENDPOINT
source-description: Extractor for Symantec ATP Endpoint Events
provides-streams:
- THREAT
master-filters:
- CEF\:\d+\|Symantec\|
event-details:
- first-match: rule\_name\=
  decoder: custom
  decoder-regex: \"(\w+)\":([^\,{}]+)
  event-key-format: '{rule_name}'
  event-key-mapping:
    'Advanced Attack Technique':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        heuristicevent_scored_process_cmdline: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Critical AVE Email Detections':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target 
    'Critical AVE detections':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Breach Detection':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Critical Cynic Detections':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Access to C&C web site(s)':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Access to malicious web site(s)':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target 
    'Multiple IoCs from one actor':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Multiple IoCs from one sha256 indicator':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Multiple IoCs from same signature and url':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Multiple detections are from one computer':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Unresolved Risk':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Multiple detections targeted to one computer':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target  
    'Critical NDC detections':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target  
    'PEP detections':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Anti-analysis technique':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Base64 encoded and compressed command line':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Download and execute .DLL':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target     
    'Content downloaded from a remote location and executed':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Execution of PS script stored in registry':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Extract and store cookie':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Execution of file-less shellcode':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Suspicious encoded PowerShell command invoked':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Invoke Mimikatz to attempt credential theft':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target 
    'Invoke a Powersploit command':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target
    'Targeted Email Attack':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target 
    'Targeted Attack':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        rule_name: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        user_name: User
        CommandLine: CommandLine
        name: File
        Url: URL
        Process: Process
        device_name: Target                                                                                                  

  fallback:
    annotate:
      EventName: Generic Symantec ATP Endpoint Event
      Stream: OTHER
  
  globals:
    translate:
      device_name: System
      device_time: SystemTstamp        