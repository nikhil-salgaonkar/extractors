schema-version: 1.0
#extractor-version: 1
extractor-id: 191
source-name: DELL-CYLANCE
source-type: ENDPOINT
source-description: extractor for Dell-Cylance Endpoint Events
provides-streams:
- THREAT
master-filters:
- '\d+\-\d+\-\d+\T\d+\:\d+\:\d+.*?CylancePROTECT\s+'
event-details:
- first-match: '\d+\-\d+\-\d+\T\d+\:\d+\:\d+.*?CylancePROTECT\s+[\-\s]+Event\s+Type\:'
  decoder: custom
  decoder-regex: '\s+([\w\s]+)\:\s+([^\,]+)\,'
  event-key-format: '{Threat Classification}'
  event-key-mapping:
    'PUP - Scripting Tool':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat Classification: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User Name: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process: Process
    
    'PUP - Generic':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat Classification: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User Name: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process: Process

    'UNCLASSIFIED':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat Classification: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User Name: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process Name: Process

    'Malware - Generic': 
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat Classification: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User Name: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process: Process

    'File Unavailable': 
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat Classification: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User Name: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process: Process

    'Trusted': 
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat Classification: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User Name: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process: Process 

    'Possible PUP': 
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat Classification: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User Name: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process: Process            
     
  fallback:
    annotate:
      EventName: Generic Dell-Cylance Endpoint Event
      Stream: OTHER

  globals:
    translate:
      'Found Date': SystemTstamp
      'Device Name': System