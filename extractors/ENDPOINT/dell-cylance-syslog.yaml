schema-version: 1.0
#extractor-version: 1
extractor-id: 191
source-name: DELL-CYLANCE
source-type: ENDPOINT
source-description: extractor for Dell-Cylance Endpoint Events
provides-streams:
- THREAT
master-filters:
- '\d+\-\d+\-\d+\T\d+\:\d+\:\d+.*?CylancePROTECT\s+'
event-details:
- first-match: 'Event\s+Type\:\s+.*?\,\s+Event\s+Name\:\s+\S+\,'
  decoder: custom
  decoder-regex: '\s+([\w\s]+)\:\s+([^\,]+)\,'
  event-key-format: '{Event Type}-{Event Name}'
  event-key-mapping:
    'ScriptControl-Alert':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User Name: User
        CommandLine: CommandLine
        File: File
        Url: URL
        Process: Process
        File Path: Suspect
        Device Name: Target
    
    'ScriptControl-Blocked':           
      annotate:
        Stream: THREAT
        Action: THREAT_BLOCKED
        Status: PASSED
        Vector: HOST
      translate:
        Threat: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User Name: User
        CommandLine: CommandLine
        File: File
        Url: URL
        Process: Process
        File Path: Suspect
        Device Name: Target

    'ExploitAttempt-blocked':           
      annotate:
        Stream: THREAT
        Action: THREAT_BLOCKED
        Status: FAILED
        Vector: HOST
      translate:
        Threat: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User Name: User
        CommandLine: CommandLine
        File: File
        Url: URL
        Process Name: Process
        Suspect: Suspect
        Device Name: Target

    'Threat-threat_quarantined': 
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process: Process
        File Name: Suspect
        Device Name: Target
    
    'Threat-threat_found': 
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process: Process
        File Name: Suspect
        Device Name: Target

    'Threat-threat_changed': 
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process: Process
        File Name: Suspect
        Device Name: Target

    'Threat-threat_cleared': 
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        Threat: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process: Process
        File Name: Suspect
        Device Name: Target  
         
    'ExploitAttempt-terminated':           
      annotate:
        Stream: THREAT
        Action: THREAT_BLOCKED
        Status: FAILED
        Vector: HOST
      translate:
        Threat: Threat
        SrcIP: SrcIP
        DstIP: DstIP
        User Name: User
        CommandLine: CommandLine
        File Name: File
        Url: URL
        Process Name: Process
        Suspect: Suspect
        Device Name: Target
        
  fallback:
    annotate:
      EventName: Generic Dell-Cylance Endpoint Event
      Stream: OTHER

  globals:
    translate:
      'Found Date': SystemTstamp
      'Device Name': System