schema-version: 1.0
#extractor-version: 1 
extractor-id: 86
source-name: ORACLE
source-type: DATABASE
source-description: Extractor for Oracle Database 
provides-streams:
- DATABASE
- AUTHENTICATION
master-filters:
- \s+Oracle\s+Audit\[\d+\]\:\s+
event-details:
- first-match: 'ACTION\:\[\d+\]\s+\"100\"\s+RETURNCODE\:\[\d+\]\s+\"\d+\"'
  decoder: regex
  decoder-regex: '(?P<DATETIME>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}).*?USERID\:\[\d+\]\s+\"(?P<USERID>\S+)\".*?USERHOST\:\[\d+\]\s+\"(?P<USERHOST>\S+)\".*?ACTION\:\[\d+\]\s+\"(?P<ACTION>\d+)\".*?RETURNCODE\:\[\d+\]\s+\"(?P<RETURNCODE>\d+)\".*?COMMENT\$TEXT\:\[\d+\]\s+\"(?P<MESSAGE>.*?(?:PROTOCOL\=(?P<PROTOCOL>\w+).*?HOST\=(?P<HOST>[\d\.]+).*?PORT\=(?P<PORT>\d+).*?)|(.*?))\"'
  event-key-format: '{ACTION}-{RETURNCODE}'
  event-key-mapping:  
    '100-0': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate: 
        USERID: User
        USERHOST: SrcHost    
        RETURNCODE: ReturnCode
        MESSAGE: Message
        PROTOCOL: Proto
        HOST: SrcIP
        PORT: SrcPort
    '100-1017': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN_FAIL_BAD_PASSWORD
        Status: FAILED
      translate: 
        USERID: User
        USERHOST: SrcHost    
        RETURNCODE: ReturnCode
        MESSAGE: Message
        PROTOCOL: Proto
        HOST: SrcIP
        PORT: SrcPort 
    '100-28000': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN_FAIL_USER_LOCKOUT
        Status: FAILED
      translate: 
        USERID: User
        USERHOST: SrcHost    
        RETURNCODE: ReturnCode
        MESSAGE: Message
        PROTOCOL: Proto
        HOST: SrcIP
        PORT: SrcPort 
    '100-2391': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN_SESSIONS_PER_USER
        Status: FAILED
      translate: 
        USERID: User
        USERHOST: SrcHost    
        RETURNCODE: ReturnCode
        MESSAGE: Message
        PROTOCOL: Proto
        HOST: SrcIP
        PORT: SrcPort           

  fallback:
      annotate:
        EventName: Generic Oracle Database Event
        Stream: OTHER

  globals:
    translate:
      DATETIME: SystemTstamp
      ACTION: EventID 

- first-match: 'ACTION\:\[\d+\]\s+\"(?:101|102)\"\s+RETURNCODE\:\[\d+\]\s+\"\d+\"'
  decoder: regex
  decoder-regex: '(?P<DATETIME>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}).*?USERID\:\[\d+\]\s+\"(?P<USERID>\S+)\".*?ACTION\:\[\d+\]\s+\"(?P<ACTION>\d+)\".*?RETURNCODE\:\[\d+\]\s+\"(?P<RETURNCODE>\d+)\"(?:.*?COMMENT\$TEXT\:\[\d+\]\s+\"(?P<MESSAGE>.*?)\")?'
  event-key-format: '{ACTION}-{RETURNCODE}'
  event-key-mapping:  
    '101-0': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED
      translate: 
        USERID: User  
        RETURNCODE: ReturnCode
        MESSAGE: Message
    '102-0': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED
      translate: 
        USERID: User  
        RETURNCODE: ReturnCode
        MESSAGE: Message    

  fallback:
      annotate:
        EventName: Generic Oracle Database Event
        Stream: OTHER

  globals:
    translate:
      DATETIME: SystemTstamp
      ACTION: EventID       