schema-version: 1.0
#extractor-version: 1
extractor-id: 242
source-name: FORTIMANAGER
source-type: FIREWALL
source-description: Extractor for FortiManager Firewall Events
provides-streams:
- AUTHENTICATION
master-filters:
- 'device_id=FM[\w\-]+\s+log_id\=\d+'
event-details:
- first-match: 'log_id\=\"?\d+\"?\s+type\=\"?.*?\"?\s+subtype\='
  decoder: custom
  decoder-regex: '([\w]+)\=(\"[^\"]*|[^\s]*)\"?'
  event-key-format: '{log_id}-{action}'
  event-key-mapping:
    '0001010018-None':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN 
        Status: PASSED
      translate:
        src: SrcIP
        AuthProto: AuthProto
        user: User 
    '0028037013-fail':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_USER
      translate:
        src: SrcIP
        AuthProto: AuthProto
        user: User
    '0001010019-None':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_PASSWORD
      translate:
        src: SrcIP
        AuthProto: AuthProto
        user: User

  fallback:
    annotate:
      EventName: Generic FortiManager Firewall Event
      Stream: OTHER

  globals:
    translate:
      date: SystemTstamp
      devname: System