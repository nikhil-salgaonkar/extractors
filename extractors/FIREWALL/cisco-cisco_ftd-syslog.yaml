schema-version: 1.0
#extractor-version: 1 
extractor-id: 230
integration: Syslog
vendor-name: Cisco
product-name: Cisco FTD
source-name: CISCO-FTD
source-type: FIREWALL
source-description: Extractor for Cisco-FTD Firewall Events
provides-streams:
- FIREWALL
- THREAT
- AUTHENTICATION
master-filters:
- '(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2}).*?[\w\-\.]+\s+\:\s+\%FTD\-\d+\-\d+\:'
event-details:
- first-match: '\%FTD\-\d+\-\d+\:\s+Teardown\s+\w+\s+connection.*?bytes'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<action>\w+).*?(?P<proto>(?:TCP|UDP|ICMP|GRE)).*?\:(?P<src>[\d\.]+)\/(?P<sport>\d+).*?(?P<dst>[\d\.]+)\/(?P<dport>\d+).*?bytes\s+(?P<txlen>\d+)'
  event-key-format: '{action}'
  event-key-mapping:  
    'Teardown': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_ESTABLISHED
        Status: FAILED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto
        sport: SrcPort
        dport: DstPort
        App: App
        txlen: TXLen
        RXLen: RXLen
        
  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Dropped'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<action>\w+).*?(?P<proto>(?:TCP|UDP|ICMP|GRE)).*?\:(?P<src>[\d\.]+)\/(?P<sport>\d+).*?(?P<dst>[\d\.]+)\/(?P<dport>\d+).*?(?P<txlen>\d+)'
  event-key-format: '{action}'
  event-key-mapping:  
    'Dropped': 
      annotate:
        Stream: FIREWALL
        Action: PACKET_BLOCKED
        Status: PASSED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto
        sport: SrcPort
        dport: DstPort
        App: App
        txlen: TXLen
        RXLen: RXLen

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:.*?Message\:\s+\\\"INDICATOR-SHELLCODE x86 NOOP\\\"\,'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+Protocol\:\s+(?P<proto>\w+).*?SrcIP\:\s+(?P<src>[\d\.]+).*?DstIP\:\s+(?P<dst>[\d\.]+).*?Message\:.*?\"(?P<threat>.*?)\\.*?Classification\:\s+(?P<action>.*?)\,.*?User\:\s+(?P<user>.*?)\,'
  event-key-format: '{action}'
  event-key-mapping:  
    'Executable Code was Detected': 
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: WEB
      translate: 
        threat: Threat
        src: SrcIP
        dst: DstIP
        user: User
        
  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:.*?(?:authentication|credentials)\s+(?:Successful|Rejected|rejected)'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:.*?(?:authentication|credentials)\s+(?P<action>\w+)(?:\s+\:.*?\=\s+(?P<reason>.*?))?\s+\:(?:\s+local\s+database\s+\:)?(?:\s+server\s+\=\s+(?P<server>[\d\.]+))?.*?user\s+\=\s+(?P<user>\w+)(?:\s+\:.*?\=\s+(?P<src>[\d\.]+))?'
  event-key-format: '{action}'
  event-key-mapping:  
    'Successful': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate: 
        user: User
        src: SrcIP
        AuthProto: AuthProto
    'Rejected': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_CREDENTIALS
      translate: 
        user: User
        src: SrcIP
        AuthProto: AuthProto
    'rejected': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_CREDENTIALS
      translate: 
        user: User
        src: SrcIP
        AuthProto: AuthProto
    
  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Authentication:\s+(?:successful|rejected)\,.*?Session\s+Type\:'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:.*?Authentication:\s+(?P<action>\w+)\,(?:.*?user\s+\=\s+(?P<user>\w+))?'
  event-key-format: '{action}'
  event-key-mapping:  
    'successful': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate: 
        user: User
        SrcIP: SrcIP
        AuthProto: AuthProto
    'rejected': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_CREDENTIALS
      translate: 
        user: User
        SrcIP: SrcIP
        AuthProto: AuthProto

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Group\s+\w+\s+User\s+\w+\s+IP\s+[\d\.]+\s+Authentication:\s+successful\,.*?Session\s+Type\:'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:.*?User\s+(?P<user>\w+)\s+IP\s+(?P<src>[\d\.]+)\s+Authentication\:\s+(?P<action>\w+)\,'
  event-key-format: '{action}'
  event-key-mapping:  
    'successful': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate: 
        user: User
        src: SrcIP
        AuthProto: AuthProto
       
  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+REAUTH\:\s+user.*?(?:failed|passed)\s+authentication'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+\w+\:\s+user\s+(?P<user>\w+)\s+(?P<action>\w+)\s+\w+'
  event-key-format: '{action}'
  event-key-mapping:  
    'passed': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate: 
        user: User
        SrcIP: SrcIP
        AuthProto: AuthProto
    'failed': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_CREDENTIALS
      translate: 
        user: User
        SrcIP: SrcIP
        AuthProto: AuthProto

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+User\s+authentication\s+(?:succeeded|failed)\:.*?IP.*?Uname\:'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+\w+\s+\w+\s+(?P<action>\w+)\:\s+IP.*?(?P<src>[\d\.]+).*?Uname\:\s+(?P<user>\w+)'
  event-key-format: '{action}'
  event-key-mapping:  
    'succeeded': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate: 
        user: User
        src: SrcIP
        AuthProto: AuthProto
    'failed': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_CREDENTIALS
      translate: 
        user: User
        src: SrcIP
        AuthProto: AuthProto

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Login\s+permitted\s+from\s+[\d\.]+\/\d+.*?user\s+\"\w+\"'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<action>.*?)\s+from\s+(?P<src>[\d\.]+).*?user\s+\"(?P<user>\w+)\"'
  event-key-format: '{action}'
  event-key-mapping:  
    'Login permitted': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate: 
        user: User
        src: SrcIP
        AuthProto: AuthProto

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Authentication\s+failed.*?user\s+\w+\s+from\s+[\d\.]+'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+\w+\s+(?P<action>\w+).*?user\s+(?P<user>\w+)\s+from\s+(?P<src>[\d\.]+).*?\.\s+(?P<reason>.*?for\s+(?P<authproto>\w+).*)'
  event-key-format: '{action}'
  event-key-mapping:  
    'failed': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_CREDENTIALS
      translate: 
        user: User
        src: SrcIP
        authproto: AuthProto

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Group.*?(?:User|Username).*?IP.*?(?:session|Session)\s+(?:started|terminated|resumed|disconnected)'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+Group\s+[\<\=]\s?(?P<group>\w+)\>?.*?(?:User|Username)\s+[\<\=]\s?(?P<user>\w+)\>?.*?IP\s+[\<\=]\s?(?P<src>[\d\.]+)\>?.*?(?P<action>(?:Session|session)\s+\w+)(?:.*?IP\s+\<(?P<server>[\d\.]+)\>)?'
  event-key-format: '{action}'
  event-key-mapping:  
    'session started': 
      annotate:
        Stream: FIREWALL
        Action: SESSION_CONNECTED
        Status: PASSED
      translate: 
        src: SrcIP
        Dst: DstIP
        Proto: Proto
        SrcPort: SrcPort
        DstPort: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen
    'session resumed': 
      annotate:
        Stream: FIREWALL
        Action: SESSION_CONNECTED
        Status: PASSED
      translate: 
        src: SrcIP
        Dst: DstIP
        Proto: Proto
        SrcPort: SrcPort
        DstPort: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen
    'session terminated': 
      annotate:
        Stream: FIREWALL
        Action: SESSION_TERMINATED
        Status: PASSED
      translate: 
        src: SrcIP
        Dst: DstIP
        Proto: Proto
        SrcPort: SrcPort
        DstPort: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen
    'Session disconnected': 
      annotate:
        Stream: FIREWALL
        Action: SESSION_DISCONNECTED
        Status: PASSED
      translate: 
        src: SrcIP
        Dst: DstIP
        Proto: Proto
        SrcPort: SrcPort
        DstPort: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen
        
  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Built\s+inbound\s+\w+\s+connection\s+\d+\s+for'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>\S+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<action>\w+)\s+\w+\s+(?P<proto>\w+).*?\:(?P<src>[\w\:\.]+)\/(?P<sport>\d+).*?\:(?P<dst>[\w\:\.]+)\/(?P<dport>\d+)'
  event-key-format: '{action}'
  event-key-mapping:  
    'Built': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_ESTABLISHED
        Status: PASSED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto
        sport: SrcPort
        dport: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Built\s+outbound\s+\w+\s+connection\s+\d+\s+for'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>\S+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<action>\w+)\s+\w+\s+(?P<proto>\w+).*?\:(?P<dst>[\w\:\.]+)\/(?P<dport>\d+).*?\:(?P<src>[\w\:\.]+)\/(?P<sport>\d+)'
  event-key-format: '{action}'
  event-key-mapping:  
    'Built': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_ESTABLISHED
        Status: PASSED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto
        sport: SrcPort
        dport: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+(?:Built\s+inbound\s+\w+\s+connection\s+for|Deny\s+\w+\s+\(no\s+connection\)\s+from|Teardown\s+ICMP connection)'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<action>\w+).*?(?P<proto>(?:TCP|UDP|ICMP|GRE)).*?\:?(?P<src>[\d\.]+)\/(?P<sport>\d+).*?(?P<dst>[\d\.]+)\/(?P<dport>\d+)'
  event-key-format: '{action}'
  event-key-mapping:  
    'Built': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_ESTABLISHED
        Status: PASSED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto
        sport: SrcPort
        dport: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen
    'Deny': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_TERMINATED
        Status: PASSED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto
        sport: SrcPort
        dport: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen
    'Teardown': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_ESTABLISHED
        Status: FAILED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto
        sport: SrcPort
        dport: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Group.*?User\s+\<\w+\>\s+IP\s+\<[\d\.]+\>.*?\s+\w+\s+(?:connection\s+established|closing\s+connection)'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+Group\s+\<\s?(?P<group>\w+)\>\s+User\s+\<(?P<user>\w+)\>\s+IP\s+\<(?P<src>[\d\.]+)\>(?:.*?(?P<proto>UDP))?.*?\w+\s+(?P<action>(?:\w+\s+)?connection(?:\s+\w+)?)'
  event-key-format: '{action}'
  event-key-mapping:  
    'connection established': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_ESTABLISHED
        Status: PASSED
      translate: 
        src: SrcIP
        DstIP: DstIP
        proto: Proto
        SrcPort: SrcPort
        Dstport: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen
    'closing connection': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_TERMINATED
        Status: PASSED
      translate: 
        src: SrcIP
        DstIP: DstIP
        proto: Proto
        SrcPort: SrcPort
        Dstport: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+(?:Built|Teardown)\s+(?:dynamic|static)\s+\w+\s+translation'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>[\w\-\.]+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<action>\w+).*?(?P<proto>\w+)\s+translation\s+from.*?\:(?P<src>[\w\:\.]+)\/(?P<sport>\d+)\s+to.*?\:(?P<dst>[\d\.]+)\/(?P<dport>\d+)'
  event-key-format: '{action}'
  event-key-mapping:  
    'Teardown': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_ESTABLISHED
        Status: FAILED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto
        sport: SrcPort
        dport: DstPort
        App: App
        txlen: TXLen
        RXLen: RXLen
    'Built': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_ESTABLISHED
        Status: PASSED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto
        sport: SrcPort
        dport: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen
        
  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Deny\s+\w+\s+src\s+\w+\:[\w\:\.]+\/\d+\s+dst\s+\w+\:[\w\:\.]+\/\d+\s+by\s+access\-group'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>\S+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<action>\w+).*?(?P<proto>\w+).*?src\s+\S+\:(?P<src>[\w\:\.]+)\/(?P<sport>\d+)\s+dst\s+\S+\:(?P<dst>[\w\:\.]+)\/(?P<dport>\d+)'
  event-key-format: '{action}'
  event-key-mapping:  
    'Deny': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_TERMINATED
        Status: PASSED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto
        sport: SrcPort
        dport: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Failed\s+to\s+locate\s+egress\s+interface\s+for\s+\w+'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>\S+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<action>\w+).*?(?P<proto>\w+)\s+from\s+\S+\:(?P<src>[\w\:\.]+)\/(?P<sport>\d+)\s+to\s+(?P<dst>[\w\:\.]+)\/(?P<dport>\d+)'
  event-key-format: '{action}'
  event-key-mapping:  
    'Failed': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_ESTABLISHED
        Status: FAILED
      translate: 
        src: SrcIP
        dst: DstIP
        Proto: Proto
        sport: SrcPort
        dport: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-\d+\:\s+Deny\s+inbound\s+protocol\s+\d+\s+src\s+\w+\:[\w\:\.]+\s+dst\s+\w+\:[\w\.\:]+'
  decoder: regex
  decoder-regex: '(?P<datetime>(?:\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}|\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})).*?(?P<hostname>\S+)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<action>\w+).*?(?P<proto>\d+)\s+src\s+\S+\:(?P<src>[\w\:\.]+)\s+dst\s+\S+\:(?P<dst>[\w\:\.]+)'
  event-key-format: '{action}'
  event-key-mapping:  
    'Deny': 
      annotate:
        Stream: FIREWALL
        Action: CONNECTION_TERMINATED
        Status: PASSED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto
        SrcPort: SrcPort
        DstPort: DstPort
        App: App
        TXLen: TXLen
        RXLen: RXLen

  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

  subs:
    Proto:
      '0': HOPOPT
      '1': ICMP
      '2': IGMP
      '3': GGP
      '4': IP-IN-IP
      '5': ST
      '6': TCP
      '7': CBT
      '8': EGP
      '9': IGP
      '10': BBN-RCC-MON
      '11': NVP-II
      '12': PUP
      '13': ARGUS
      '14': EMCON
      '15': XNET
      '16': CHAOS
      '17': UDP
      '18': MUX
      '19': DCN-MEAS
      '20': HMP
      '21': PRM
      '22': XNS-IDP
      '23': TRUNK-1
      '24': TRUNK-2
      '25': LEAF-1
      '26': LEAF-2
      '27': RDP
      '28': IRTP
      '29': ISO-TP4
      '30': NETBLT
      '31': MFE-NSP
      '32': MERIT-INP
      '33': DCCP
      '34': 3PC
      '35': IDPR
      '36': XTP
      '37': DDP
      '38': IDPR-CMTP
      '39': TP++
      '40': IL
      '41': IPV6
      '42': SDRP
      '43': IPV6-ROUTE
      '44': IPV6-FRAG
      '45': IDRP
      '46': RSVP
      '47': GRE
      '48': DSR
      '49': BNA
      '50': ESP
      '51': AH
      '52': I-NLSP
      '53': SWIPE
      '54': NARP
      '55': MOBILE
      '56': TLSP
      '57': SKIP
      '58': IPV6-ICMP
      '59': IPV6-NONXT
      '60': IPV6-OPTS
      '62': CFTP
      '64': SAT-EXPAK
      '65': KRYPTOLAN
      '66': RVD
      '67': IPPC
      '69': SAT-MON
      '70': VISA
      '71': IPCU
      '72': CPNX
      '73': CPHB
      '74': WSN
      '75': PVP
      '76': BR-SAT-MON
      '77': SUN-ND
      '78': WB-MON
      '79': WB-EXPAK
      '80': ISO-IP
      '81': VMTP
      '82': SECURE-VMTP
      '83': VINES
      '84': IPTM
      '85': NSFNET-IGP
      '86': DGP
      '87': TCF
      '88': EIGRP
      '89': OSPF
      '90': SPRITE-RPC
      '91': LARP
      '92': MTP
      '93': AX.25
      '94': OS
      '95': MICP
      '96': SCC-SP
      '97': ETHERIP
      '98': ENCAP
      '100': GMTP
      '101': IFMP
      '102': PNNI
      '103': PIM
      '104': ARIS
      '105': SCPS
      '106': QNX
      '107': A/N
      '108': IPCOMP
      '109': SNP
      '110': COMPAQ-PEER
      '111': IPX-IN-IP
      '112': VRRP
      '113': PGM
      '115': L2TP
      '116': DDX
      '117': IATP
      '118': STP
      '119': SRP
      '120': UTI
      '121': SMP
      '122': SM
      '123': PTP
      '124': IS-IS-OVER-IPV4
      '125': FIRE
      '126': CRTP
      '127': CRUDP
      '128': SSCOPMCE
      '129': IPLT
      '130': SPS
      '131': PIPE
      '132': SCTP
      '133': FC
      '134': RSVP-E2E-IGNORE
      '135': MOBILITY-HEADER
      '136': UDPLITE
      '137': MPLS-IN-IP
      '138': MANET
      '139': HIP
      '140': SHIM6
      '141': WESP
      '142': ROHC
      '255': RESERVED