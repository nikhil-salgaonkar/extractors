schema-version: 1.0
#extractor-version: 1 
extractor-id: 230
source-name: CISCO-FTD
source-type: FIREWALL
source-description: Extractor for Cisco-FTD Firewall Events
provides-streams:
- NETWORK-FIREWALL
- NETWORK-THREAT
- AUTHENTICATION
master-filters:
- \s+\%FTD\-\d+\-\d+\:\s+
event-details:
- first-match: '\%FTD\-\d+\-106021\:'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})(?:\s+.*?)?\s+(?P<hostname>.*?)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<msg>.*?\s+(?P<proto>.*?)\s+.*?)from\s+(?P<src>.*?)\s+to\s+(?P<dst>.*?)\s+.*'
  event-key-format: '{eventid}'
  event-key-mapping:  
    '106021': 
      annotate:
        Stream: NETWORK-THREAT
        Action: THREAT_DETECTED
        Status: PASSED
      translate: 
        src: SrcIP
        dst: DstIP
        proto: Proto    
    
  fallback:
    annotate:
       EventName: Generic Cisco-FTD Firewall Event
       Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\%FTD\-\d+\-(?:113004|113005)\:'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{4}\s+\d{2}\:\d{2}\:\d{2})\s+(?P<hostname>.*?)\s+\:\s+%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<msg>.*?)(?:\s+\:\s+reason\s+\=\s+(?P<reason>.*?))?\s+\:\s+server\s+\=\s+(?P<serverip>.*?)\s+\:\s+user\s+\=\s+(?P<user>\S+)(?:\s+\:\s+user\s+IP\s+\=\s+(?P<src>\S+))?'
  event-key-format: '{eventid}'
  event-key-mapping:  
    '113004': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
        AuthMethod: VPN
        Reason: '-'
      translate: 
        user: User
        src: SrcIP
    '113005': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        AuthMethod: '-'
        Reason: INVALID_PASSWORD
      translate: 
        user: User
        src: SrcIP 
           
    
  fallback:
    annotate:
      EventName: Generic Cisco-FTD Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System
