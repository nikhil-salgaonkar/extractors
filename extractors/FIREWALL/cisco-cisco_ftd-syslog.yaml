schema-version: 1.0
#extractor-version: 1 
extractor-id: 230
source-name: CISCO-FTD
source-type: FIREWALL
source-description: Extractor for Cisco-FTD Firewall 
provides-streams:
- NETWORK-FIREWALL
master-filters:
- \s+\%FTD\-\d+\-\d+\:\s+
event-details:
- first-match: '\%FTD\-6\-(?:302014|302016|302015|302013)\:'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})(?:\s+.*?)?\s+(?P<hostname>.*?)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<msg>.*?\s+(?:(?P<flow>inbound)\s+)?(?P<proto>\w+)\s+.*?)\s+(?P<connectionid>\d+)\s+for.*?\:(?P<src>[abcdef \w \d \:\.\-]+)\/(?P<sport>\d+).*?to.*?\:(?P<dst>[abcdef \w \d \:\.\-]+)\/(?P<dport>\d+)(?:.*?duration\s+(?P<duration>.*?)\s+.*?bytes\s+(?P<bytes>\d+).*)?'
  event-key-format: '{eventid}'
  event-key-mapping:  
    '302014': 
      annotate:
        Stream: NETWORK-FIREWALL
        Action: PACKET_TEARDOWN
        Status: PASSED
      translate: 
        msg: Message
        src: SrcIP    
        sport: SrcPort
        dst: DstIP
        proto: Proto
        dport: DstPort
        bytes: TXLen 
        severity: Severity
    '302016': 
      annotate:
        Stream: NETWORK-FIREWALL
        Action: PACKET_TEARDOWN
        Status: FAILED
      translate: 
        msg: Message
        src: SrcIP    
        sport: SrcPort
        dst: DstIP
        dport: DstPort
        proto: Proto
        bytes: TXLen 
        severity: Severity
    '302015':
      annotate:
        Stream: NETWORK-FIREWALL
        Action: PACKET_ALLOWED
        Status: FAILED
      translate: 
        msg: Message
        src: SrcIP    
        sport: SrcPort
        dst: DstIP
        proto: Proto
        dport: DstPort
        flow: Flow
        severity: Severity
    '302013':
      annotate:
        Stream: NETWORK-FIREWALL
        Action: PACKET_ALLOWED
        Status: FAILED
      translate: 
        msg: Message
        src: SrcIP    
        sport: SrcPort
        dst: DstIP
        proto: Proto
        dport: DstPort
        flow: Flow  
        severity: Severity   
                
  fallback:
      annotate:
        EventName: Generic Cisco-FTD Firewall Event
        Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: SystemName 

- first-match: '\%FTD\-6\-(?:106023)\:'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})(?:\s+.*?)?\s+(?P<hostname>.*?)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+\d+)\:\s+(?P<msg>Deny\s+(?P<proto>\w+))\s+.*?\:(?P<src>[abcdef\w \d \:\.\-]+)(?:\/(?P<sport>\d+.*?)\s+)?dst\s+.*?\:(?P<dst>[abcdef\w \d \:\.\-]+)(?:\/(?P<dport>\d+.*?))?.*?access-group\s+\"(?P<policyname>.*?)\"'
  event-key-format: '{eventid}'
  event-key-mapping:  
    '106023': 
      annotate:
        Stream: NETWORK-FIREWALL
        Action: PACKET_BLOCKED
        Status: FAILED
      translate: 
        msg: Message
        src: SrcIP    
        sport: SrcPort
        dst: DstIP
        dport: DstPort
        proto: Proto
        policyname: PolicyName
        severity: Severity
    
  fallback:
      annotate:
        EventName: Generic Cisco-FTD Firewall Event
        Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: SystemName       

- first-match: '\%FTD\-6\-(?:302021|302020)\:'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})(?:\s+.*?)?\s+(?P<hostname>.*?)\s+\:\s+\%FTD\-(?P<severity>\d+)\-(?P<eventid>\d+)\:\s+(?P<msg>.*?(?:(?P<flow>inbound))?\s+(?P<proto>\w+)\s+connection).*?faddr\s+(?P<src>.*?)\/(?P<sport>.*?)\s+gaddr\s+(?P<dst>.*?)\/(?P<dport>\d+).*?\s+type\s(?P<type>.*?)\s+code\s(?P<code>\d+)'
  event-key-format: '{eventid}'
  event-key-mapping:  
    '302021': 
      annotate:
        Stream: NETWORK-FIREWALL
        Action: PACKET_TEARDOWN
        Status: FAILED
      translate: 
        msg: Message
        src: SrcIP    
        sport: SrcPort
        dst: DstIP
        dport: DstPort
        proto: Proto
        policyname: PolicyName
        severity: Severity
        type: ICMPType
        code: ICMPCode
    '302020': 
      annotate:
        Stream: NETWORK-FIREWALL
        Action: PACKET_ALLOWED
        Status: FAILED
      translate: 
        msg: Message
        src: SrcIP    
        sport: SrcPort
        dst: DstIP
        dport: DstPort
        proto: Proto
        policyname: PolicyName
        severity: Severity
        type: ICMPType
        code: ICMPCode
        flow: Flow    
    
  fallback:
      annotate:
        EventName: Generic Cisco-FTD Firewall Event
        Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: SystemName             