schema-version: 1.0
#extractor-version: 1
extractor-id: 58
source-name: JUNIPER-SRX
source-type: FIREWALL
source-description: Extractor for Juniper-SRX Firewall Events
provides-streams:
- NETWORK-FIREWALL
- AUTHENTICATION
master-filters:
- '\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}\s+\S+\s+\S+\:\s+\S+\:\s+'
event-details:
- first-match: '\s+UI_LOGIN_EVENT.*?j\-super\-user.*?client-mode\s+cli'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})\s+(?P<hostname>\S+)\s+(?P<daemon>\w+)\[(?P<pid>\d+)\]\:\s+(?P<category>\S+)\:\s+.*?\s(?P<user>.*?)\slogin.*?ssh-connection\s+(?P<src>[\d\.]+)\s+(?P<sport>\d+)\s+(?P<dst>[\d\.]+)\s+(?P<dport>\d+)'
  event-key-format: '{category}'
  event-key-mapping:
    'UI_LOGIN_EVENT': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED   
        AuthMethod: SSH
        Reason: '-'
      translate:
        src: SrcIP 
        user: User

  fallback:
    annotate:
      EventName: Generic Juniper-SRX Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\s+UI_LOGOUT_EVENT\:'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})\s+(?P<hostname>\S+)\s+(?P<daemon>.*?)\[(?P<pid>\d+)\]\:\s+(?P<category>\S+)\:\s.*?\s(?P<user>\w+)\s+'
  event-key-format: '{category}'
  event-key-mapping:
    'UI_LOGOUT_EVENT': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED
        AuthMethod: '-'  
      translate:
        user: User
        src: SrcIP

  fallback:
    annotate:
      EventName: Generic Juniper-SRX Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\s+SSHD_LOGIN_FAILED\:'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})\s+(?P<hostname>\S+)\s+(?P<daemon>\w+)\:\s+(?P<category>\S+)\:.*?user\s+(?P<user>.*?)\s+.*?(?P<src>[\d\.]+)'
  event-key-format: '{category}'
  event-key-mapping:
    'SSHD_LOGIN_FAILED': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        AuthMethod: SSH
        Reason: INVALID_PASSWORD   
      translate:
        user: User
        src: SrcIP   

  fallback:
    annotate:
      EventName: Generic Juniper-SRX Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\s+UI_DBASE_LOGIN_EVENT\:'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})\s+(?P<hostname>\S+)\s+(?P<daemon>\w+)\[(?P<pid>\d+)\]\:\s+(?P<category>\S+)\:\s+User\s+(?P<user>.*?)\s+'
  event-key-format: '{category}'
  event-key-mapping:
    'UI_DBASE_LOGIN_EVENT': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED  
        AuthMethod: '-'
        Reason: '-'
      translate:
        user: User
        src: SrcIP

  fallback:
    annotate:
      EventName: Generic Juniper-SRX Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System

- first-match: '\s+UI_DBASE_LOGOUT_EVENT\:'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})\s+(?P<hostname>\S+)\s+(?P<daemon>\w+)\[(?P<pid>\d+)\]\:\s+(?P<category>\S+)\:\s+User\s+(?P<user>.*?)\s+'
  event-key-format: '{category}'
  event-key-mapping:
    'UI_DBASE_LOGOUT_EVENT': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED
        AuthMethod: '-'  
      translate:
        user: User
        src: SrcIP

  fallback:
    annotate:
      EventName: Generic Juniper-SRX Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System
  
- first-match: '\sUI_LOGIN_EVENT.*?\sclass.*?\s+super\-user'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})\s+(?P<hostname>\S+)\s+(?P<daemon>\w+)\[(?P<pid>\d+)\]\:\s(?P<category>\S+)\:\sUser\s(?P<user>\S+)\s+'
  event-key-format: '{category}'
  event-key-mapping:
    'UI_LOGIN_EVENT': 
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED  
        AuthMethod: SSH
        Reason: '-'
      translate:
        user: User
        src: SrcIP

  fallback:
    annotate:
      EventName: Generic Juniper-SRX Firewall Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System