schema-version: 1.0
#extractor-version: 1
extractor-id: 161
source-name: MIMECAST
source-type: EMAIL-GATEWAY
source-description: extractor for Mimecast Events
provides-streams:
- EMAIL-GATEWAY
- AUTHENTICATION
- THREAT
- IAM
master-filters:
- '(?:datetime|date)\=\d{4}\-\d{2}\-\d{2}T\d{2}\:\d{2}\:\d{2}\+\d+\|(?:mcType|aCode|acc)\=\"?[\w\_]+'
event-details:
- first-match: '(?:datetime|date)\=\d{4}\-\d{2}\-\d{2}T\d{2}\:\d{2}\:\d{2}\+\d+\|(?:mcType|aCode|acc)\='
  decoder: custom
  decoder-regex: (\w+)\=([^|]+)
  event-key-format: '{action}-{auditType}-{Delivered}-{Act}-{UrlCategory}-{reason}'
  event-key-mapping:
    'failure-Logon Authentication Failed-None-None-None-None':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        AuthMethod: '-'
      translate:
        src: SrcIP
        user: User
        eventInfo: Reason
    'success-User Logged On-None-None-None-None':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
        AuthMethod: '-'
      translate:
        src: SrcIP
        user: User
        eventInfo: Reason
    'None-Account Updated-None-None-None-None':
      annotate:
        Stream: IAM
        Action: USER_ACCOUNT_UPDATED
        Status: PASSED
      translate:
        Administrator: AdminUser
        Accountdetails: AccountDetails
        user: User
    'None-New Policy-None-None-None-None':
      annotate:
        Stream: IAM
        Action: POLICY_CREATED
        Status: PASSED
      translate:
        Administrator: AdminUser
        user: User      
        Policydetails: PolicyDetails 
    'None-Policy Deleted-None-None-None-None':
      annotate:
        Stream: IAM
        Action: POLICY_DELETED
        Status: PASSED
      translate:
        Administrator: AdminUser
        user: User      
        Policydetails: PolicyDetails 
    'None-Existing User Role Updated-None-None-None-None':
      annotate:
        Stream: IAM
        Action: USER_ROLE_UPDATED
        Status: PASSED
      translate:
        Administrator: AdminUser      
        Rolename: RoleName 
    'None-User removed from role-None-None-None-None':
      annotate:
        Stream: IAM
        Action: USER_REMOVED
        Status: PASSED
      translate:
        Administrator: AdminUser      
        Rolename: RoleName  
        user: User 
    'None-User added from role-None-None-None-None':
      annotate:
        Stream: IAM
        Action: USER_ADDED
        Status: PASSED
      translate:
        Administrator: AdminUser      
        Rolename: RoleName  
        user: User
    'None-User Password Changed-None-None-None-None':
      annotate:
        Stream: IAM
        Action: ACCOUNT_PASSWORD_RESET
        Status: PASSED
      translate:
        Administrator: AdminUser      
        src: SrcIP
        user: User 
    'None-None-true-None-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_DELIVERED
      translate:
        IP: DstIP
        Dir: Flow
        Subject: Subject
        Sender: Sender
        Rcpt: Recipient
        AttSize: AttachmentSize
        Snt: TXLen
        AttNames: AttachmentName
        AttCnt: AttachmentCount
        protocol: Proto 
    'None-None-None-Acc-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_ACCEPTED
      translate:
        IP: SrcIP
        Dir: Flow
        Subject: Subject
        Sender: Sender
        Rcpt: Recipient
        protocol: Proto 
        SpamInfo: SpamInfo
        SpamScore: SpamScore
        AttNames: AttachmentName
        AttCnt: AttachmentCount
        AttSize: AttachmentSize
    'None-None-None-Rej-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_REJECTED
      translate:
        IP: SrcIP
        Dir: Flow
        Subject: Subject
        Sender: Sender
        Rcpt: Recipient  
        RejInfo: RejInfo
        SpamScore: SpamScore
        RejType: RejType
        AttNames: AttachmentName
        AttCnt: AttachmentCount
        AttSize: AttachmentSize
    'None-None-false-None-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_DELIVERED
        Status: FAILED
      translate:
        IP: SrcIP
        Dir: Flow
        Subject: Subject
        Sender: Sender
        Rcpt: Recipient
        Snt: TXLen  
        RejInfo: RejInfo
        RejType: RejType
        AttSize: AttachmentSize  
        AttNames: AttachmentName
        AttCnt: AttachmentCount  
    'None-None-None-Bnc-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_BOUNCED
      translate:
        IP: SrcIP
        Dir: Flow
        Subject: Subject
        Sender: Sender
        Rcpt: Recipient
        SpamLimit: SpamLimit
        SpamInfo: SpamInfo
        SpamScore: SpamScore
        AttNames: AttachmentName
        AttCnt: AttachmentCount
        AttSize: AttachmentSize
    'None-None-None-Hld-None-None':
      annotate:
        Stream: EMAIL-GATEWAY
        Action: EMAIL_HOLD
      translate:
        Sender: Sender
        Rcpt: Recipient
        Subject: Subject
        AttNames: AttachmentName
        AttCnt: AttachmentCount
        AttSize: AttachmentSize
    'None-None-None-None-None-malicious':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
      translate:
        sourceIp: SrcIP
        url: URL
        route: Flow
        subject: Subject
        Sender: Sender
        senderDomain: SenderDomain
        recipient: Recipient
        urlCategory: URLCategory    
        reason: Reason
    'None-None-None-None-Phishing & Fraud-None':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
      translate:
        sourceIp: SrcIP
        URL: URL
        route: Flow
        Subject: Subject
        Sender: Sender
        senderDomain: SenderDomain
        Recipient: Recipient
        UrlCategory: URLCategory
        Reason: Reason                           

  fallback:
      annotate:
        EventName: Generic Mimecast Event
        Stream: OTHER

  globals:
    translate:
        date: SystemTstamp
        Hostname: System        