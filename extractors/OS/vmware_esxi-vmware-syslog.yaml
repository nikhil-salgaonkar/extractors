schema-version: 1.0
#extractor-version: 1
extractor-id: 98
source-name: VMWARE
source-type: OS
source-description: Extractor for VMWARE OS Events
provides-streams:
- AUTHENTICATION
master-filters:
- '\d{4}\-\d+\-\d+T\d+\:\d+\:\d+[\.\w]+.*?(?:smbiosDump|Hostd|vmkernel|Vpxa|vobd|lwsmd|Rhttpproxy|hostd\-probe|storageRM|cimslp|smartd|heartbeat|sdrsInjector|vmkwarning|vsantraced|vmon|vpxd|vmcad|vmdird|Fdm|localcli|backup\.sh\.\d+|vmauthd|sfcb-vmware_raw|slpd)'
event-details:
- first-match: '\s+Hostd\:\s+info\s+hostd.*?logged\s+out'
  decoder: regex
  decoder-regex: '(?P<datetime>\d+\-\d+\-\d+T\d+\:\d+\:\d+)\.\w+\s+(?P<hostname>\S+)\s+(?P<daemon>\S+)\:\s+(?P<severity>\w+)\s+(?P<appserverice>\w+).*?(?:user=|User)\s+(?P<user>.*?)\@.*?(?P<action>logged\s+out)\s+'
  event-key-format: '{action}'
  event-key-mapping:
    'logged out':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED
      translate:
        user: User
        src: SrcIP
        reason: Reason
        AuthProto: AuthProto

  fallback:
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate:
        user: User
        src: SrcIP
        reason: Reason
        AuthProto: AuthProto

  fallback:
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        Reason: INVALID_PASSWORD
      translate:
        user: User
        src: SrcIP
        AuthProto: AuthProto

  fallback:
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
      translate:
        user: User
        src: SrcIP
        reason: Reason
        AuthProto: AuthProto
    'logged out':
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED
      translate:
        user: User
        src: SrcIP
        reason: Reason
        AuthProto: AuthProto    

  fallback:
      annotate:
        EventName: Generic VMWARE OS Event
        Stream: OTHER
  globals:
    translate:
      datetime: SystemTstamp
      hostname: System