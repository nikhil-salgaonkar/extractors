schema-version: 1.0
#extractor-version: 1
extractor-id: 253
source-name: AKAMAI-CEF
source-type: WAF
source-description: extractor for Akamai WAF Events
provides-streams:
- WAF
master-filters:
- 'CEF\:\d+\|Akamai\|akamai_siem\|'
event-details:  
- first-match: 'CEF\:\d+\|Akamai\|akamai_siem\|'
  decoder: custom
  decoder-regex: '([\w]+)\=([^\s]*)'
  event-key-format: '{act}-{AkamaiSiemResponseStatus}'
  decoder-header: CEF
  event-key-mapping:
    'alert-200':           
      annotate:
        Stream: WAF
        Action: URL_ALLOWED
        Status: PASSED
      translate: 
        src: SrcIP
        requestMethod: Method
        AkamaiSiemResponseStatus: RetCode
        dpt: DstPort
        dhost: DstHost
        request: URL
        Header-5: EventName
        Header-6: Severity
    'deny-403':
      annotate:
        Stream: WAF
        Action: URL_BLOCKED
        Status: FAILED
        Blocked: 'YES'
      translate: 
        src: SrcIP
        requestMethod: Method
        AkamaiSiemResponseStatus: RetCode
        dpt: DstPort
        dhost: DstHost
        request: URL
        Header-5: EventName
        Header-6: Severity

  fallback:
    annotate:
      EventName: Generic Akamai WAF Event
      Stream: OTHER

  globals:
    translate:
      start: SystemTstamp

  subs:
    Severity:
      '0': 'LOW'
      '1': 'LOW'
      '2': 'LOW'
      '3': 'MEDIUM'
      '4': 'MEDIUM'
      '5': 'HIGH'
      '6': 'HIGH'
      '7': 'HIGH'
      '8': 'CRITICAL'
      '9': 'CRITICAL'
      '10': 'CRITICAL'
      'LOW': 'LOW'
      'HIGH': 'HIGH'
      'MEDIUM': 'MEDIUM'
      'CRITICAL': 'CRITICAL'