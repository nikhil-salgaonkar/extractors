schema-version: 1.0
#extractor-version: 1
extractor-id: 150
source-name: F5BIGIP-CEF
source-type: WAF
source-description: extractor for F5-BigIP WAF Events
provides-streams:
- WAF
master-filters:
- CEF\:\d+\|F5\|ASM\|

event-details:  
- first-match: CEF\:\d+\|F5\|ASM\|
  decoder: custom
  decoder-regex: ([\w]+)\=([^\s]*)
  event-key-format: '{act}'
  decoder-header: CEF
  event-key-mapping:
    passed:           
      annotate:
        Stream: WAF
        Action: URL_ALLOWED
        Status: PASSED
      translate: 
        src: SrcIP
        requestMethod: Method
        cn1: ReturnCode
        spt: SrcPort
        url: URL
        Header-5: EventName
        Header-6: Severity
    blocked:           
      annotate:
        Stream: WAF
        Action: URL_BLOCKED
        Status: FAILED
      translate: 
        src: SrcIP
        requestMethod: Method
        cn1: ReturnCode
        spt: SrcPort
        url: URL
        Header-5: EventName
        Header-6: Severity
        
  fallback:
    annotate:
      EventName: Generic F5-BigIP Event
      Stream: OTHER

  globals:
    translate:
      dvchost: System

  subs:
    Severity:
      '0': 'LOW'
      '1': 'LOW'
      '2': 'LOW'
      '3': 'MEDIUM'
      '4': 'MEDIUM'
      '5': 'HIGH'
      '6': 'HIGH'
      '7': 'HIGH'
      '8': 'CRITICAL'
      '9': 'CRITICAL'
      '10': 'CRITICAL'
      'LOW': 'LOW'
      'HIGH': 'HIGH'
      'MEDIUM': 'MEDIUM'
      'CRITICAL': 'CRITICAL'