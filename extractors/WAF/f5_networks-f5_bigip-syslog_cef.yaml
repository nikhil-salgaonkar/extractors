schema-version: 1.0
#extractor-version: 1
extractor-id: 150
source-name: F5BIGIP-CEF
source-type: WAF
source-description: extractor for F5-BigIP WAF Events
provides-streams:
- THREAT
master-filters:
- CEF\:\d+\|F5\|ASM\|
event-details:  
- first-match: CEF\:\d+\|F5\|ASM\|
  decoder: custom
  decoder-regex: ([\w]+)\=([^\s]*)
  event-key-format: '{Header-4}'
  decoder-header: CEF 
  event-key-mapping:
    'Illegal HTTP status in response':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: WEB
      translate: 
        cs4: Threat 
        src: SrcIP
        dst: DstIP
        suser: User    
    'Check maximum number of headers':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: WEB
      translate: 
        cs4: Threat 
        src: SrcIP
        dst: DstIP
        suser: User   
    '200021069':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: WEB
      translate: 
        cs4: Threat 
        src: SrcIP
        dst: DstIP
        suser: User    
    'Illegal query string length':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: WEB
      translate: 
        cs4: Threat 
        src: SrcIP
        dst: DstIP
        suser: User    
    '200000098':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: WEB
      translate: 
        cs4: Threat 
        src: SrcIP
        dst: DstIP
        suser: User    
    'DoS Attack':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: WEB
      translate:
        cs4: Threat 
        src: SrcIP
        dst: DstIP
        suser: User 
    'Brute Force Attack':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: WEB
      translate:
        cs4: Threat 
        src: SrcIP
        dst: DstIP
        suser: User 
    'IP Enforcer Attack':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: WEB
      translate:
        cs4: Threat 
        src: SrcIP
        dst: DstIP
        suser: User 
    'Web Scraping Attack':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: WEB
      translate:
        cs4: Threat 
        src: SrcIP
        dst: DstIP
        suser: User      

  fallback:
    annotate:
      EventName: Generic F5-BigIP Event
      Stream: OTHER

  globals:
    translate:
      rt: SystemTstamp
      dvchost: System