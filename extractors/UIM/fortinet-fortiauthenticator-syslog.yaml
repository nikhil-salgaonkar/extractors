schema-version: 1.0
#extractor-version: 1
extractor-id: 259
source-name: FORTINET-FORTIAUTHENTICATOR
source-type: UIM
source-description: extractor for Fortiauthenticator
provides-streams:
- AUTHENTICATION
- ADMINISTRATOR
master-filters:
- db\[\d+\]\:\s+category\=\"Event\"\s+subcategory\=\"[\w\s]+\"\s+typeid\=\d+\s+

event-details:  
- first-match: category\=\"\w+\"\s+subcategory\=\"[\w\s]+\"\s+
  decoder: custom
  decoder-regex: ([\w]+)\=(\"[^\"]+\"|[^\s]+)
  event-key-format: '{action}-{status}'       
  event-key-mapping:
    Authentication-Success:           
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED    
      translate: 
        user: User
        nas: SrcIP
    Edit-:
      annotate:
        Stream: ADMINISTRATOR
        Action: CONFIGURATION_CHANGED
        Status: PASSED    
      translate: 
        user: User
        nas: SrcIP
        
  fallback:
      annotate:
        EventName: Generic Fortiauthenticator Event
        Stream: OTHER
      translate:
        level: LogLevel
        category: Category
        subcategory: SubCategory
        typeid: EventID


  globals:
    translate:
      level: LogLevel
      category: Category
      subcategory: SubCategory
      typeid: EventID