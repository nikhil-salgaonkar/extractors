schema-version: 1.0
#extractor-version: 1
extractor-id: 68
source-name: IIS
source-type: WEBSERVER
source-description: Extractor for IIS Webserver Events
provides-streams:
- WEBSERVER
master-filters:
- \"SourceModuleName\"\:\"IISin
event-details:
- first-match: \"SourceModuleName\"\:\"IISin
  decoder: json
  event-key-format: '{HTTPRetCode}'
  event-key-mapping:
    '200':
      annotate:
        Stream: WEBSERVER
        Action: URL_ALLOWED
        Status: PASSED
      translate:
        SourceIP: SrcIP
        HTTPReferer: Referrer
        HTTPMethod: Method
        HTTPRetCode: ReturnCode
        TXLen: TXLen
        RXLen: RXLen
        SourcePort: SrcPort
        DstPort: DstPort
        UserName: User
        UserAgent: UserAgent
        URIQuery: URIQuery


  fallback:
    annotate:
      EventName: Generic IIS Webserver Event
      Stream: OTHER

  globals:
    translate:
      EventReceivedTime: SystemTstamp
      SystemName: System