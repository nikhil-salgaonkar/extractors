schema-version: 1.0
#extractor-version: 1
extractor-id: 112
source-name: WEBLOGIC
source-type: WEBSERVER
source-description: extractor for Weblogic Webserver
provides-streams:
- WEBSERVER
master-filters:
- Weblogic\s+logs\s+forwarded\s+\:\s+

event-details:  
- first-match: Weblogic\s+logs
  decoder: regex
  decoder-regex: Weblogic\s+logs\s+forwarded\s+\:\s+(?:(?P<src_ip>[\d\.\:]+)\s+)?.*?\[?(?P<datetime>\d+(?:\/|\-)?\d+(?:\/|\-)?\d+(?:\:|\s+)?\d+\:\d+\:\d+).*?(?P<method>GET|POST)\s+(?:[\w\-]+\s+\d+\s+)?(?P<url>.*?)\s+(?P<status_code>\d+)\s+(?P<txlen>\d+)
  event-key-format: '{status_code}'
  #decoder-header: CEF
  event-key-mapping:
    '200':           
      annotate:
        Stream: WEBSERVER
      translate: 
        src_ip: SrcIP
        method: Method
        status_code: ReturnCode
        txlen: TXLen
        
  fallback:
      annotate:
        EventName: Generic Weblogic Event
        Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp