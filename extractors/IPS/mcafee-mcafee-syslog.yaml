schema-version: 1.0
#extractor-version: 1 
extractor-id: 152
integration: Syslog
vendor-name: McAfee
product-name: McAfee
source-name: MCAFEE
source-type: IPS
source-description: Extractor for McAfee IPS Events
provides-streams:
- THREAT
master-filters:
- '^(?:\<\d+\>)?\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}\s+.*?(?:SyslogAlertForwarder|AlertLog)\:'
event-details:
- first-match: '^(?:\<\d+\>)?\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}\s+.*?(?:SyslogAlertForwarder|AlertLog)\:\s+\S+\s+detected\s+\S+\s+attack\s+'
  decoder: regex
  decoder-regex: '^(?:\<\d+\>)?(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}).*?(?:SyslogAlertForwarder|\S+\s+AlertLog)\:\s+(?P<hostname>\S+)\s+detected\s+\S+\s+attack\s+(?P<attack>.*?)\s+\(severity.*?\.\s+(?P<src>\S+)\:\S+\s+\-\>\s+(?P<dst>\S+)\:'
  event-key-format: ''
  event-key-mapping:
    '': 
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: NETWORK
      translate: 
        src: SrcIP
        dst: DstIP
        attack: Threat                    
                               
  fallback:
    annotate:
      EventName: Generic McAfee IPS Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System