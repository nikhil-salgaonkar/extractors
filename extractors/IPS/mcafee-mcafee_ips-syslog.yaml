schema-version: 1.0
#extractor-version: 1
extractor-id: 173
source-name: MCAFEE
source-type: IPS
source-description: extractor for Mcafee IPS Events
provides-streams:
- NETWORK-THREAT
master-filters:
- \s+SyslogAlertForwarder\:.*?(?:Signature|Statistical\s+Anomaly).*?\(result\s+\=\s+.*?\)
event-details:
- first-match: '\s+(?:Signature|Statistical\s+Anomaly).*?\(result\s+\=\s+.*?\)'
  decoder: regex
  decoder-regex: '\<\d+\>(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})\s+.*?\:\s+\d+\s+(?P<atkclass>.*?)\s+(?P<detecteddatetime>\d{4}\-\d{2}\-\d{2}\s+\d{2}\:\d{2}\:\d{2})\s+IST\s+(?P<atkmsg>.*?)\s+0x\w+\s+(?P<severity>\w+)\s+.*?(?P<risklevel>(?:Low|N\/A|Medium|High))(?P<domain>.*?[\s \w]+)\s+(?P<hostname>.*?)\s+(?P<interface>.*?)\s+(?P<src>[\w\d\/\.]+)\s+(?P<sport>[\w\d\/\.]+)\s+(?:.*?(?P<dst>[\w\d\/\.]+)\s+)?(?:.*?(?P<dport>[\w\d\/\.]+)\s+)\(result\s+\=\s+(?P<result>.*?)\)'
  event-key-format: '{result}'
  event-key-mapping:
    'Smart Blocked':
      annotate:
        Stream: NETWORK-THREAT
        Action: THREAT_BLOCKED
        Status: PASSED
        Blocked: 'YES'
      translate:
        atkmsg: AtkMsg
        src: SrcIP
        sport: SrcPort
        dport: DstPort
        dst: DstIP 
    'Attack Failed': 
      annotate:
        Stream: NETWORK-THREAT
        Action: THREAT_BLOCKED
        Status: FAILED
        Blocked: 'YES'
      translate:
        atkmsg: AtkMsg
        src: SrcIP
        sport: SrcPort
        dport: DstPort
        dst: DstIP 
    'Attack Successful':
      annotate:
        Stream: NETWORK-THREAT
        Action: THREAT_DETECTED
        Status: PASSED
      translate:
        atkmsg: AtkMsg
        src: SrcIP
        sport: SrcPort
        dport: DstPort
        dst: DstIP   
    'Attack Blocked':
      annotate:
        Stream: NETWORK-THREAT
        Action: THREAT_BLOCKED
        Status: PASSED
        Blocked: 'YES'
      translate:
        atkmsg: AtkMsg
        src: SrcIP
        sport: SrcPort
        dport: DstPort
        dst: DstIP    
    'Inconclusive': 
      annotate:
        Stream: NETWORK-THREAT
        Action: THREAT_DETECTED
        Status: PASSED
      translate:
        atkmsg: AtkMsg
        src: SrcIP
        sport: SrcPort
        dport: DstPort
        dst: DstIP         

  fallback:
    annotate:
      EventName: Generic Mcafee NETWORK-THREAT Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      #detecteddatetime: DetectedTstamp
      hostname: System