schema-version: 1.0
#extractor-version: 1
extractor-id: 145
source-name: CISCO-FIREPOWER
source-type: IPS
source-description: extractor for CISCO-FIREPOWER Events
provides-streams:
- WEBFILTER
master-filters:
- \w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}.*?\w+\:\s+Protocol\:\s
event-details:
- first-match: \w+\s+\d+\s+\d+\:\d+\:\d+\s+\S+.*?AccessControlRuleAction\:\s
  decoder: custom
  decoder-regex: \s([^,]+)\:\s([^,]+)
  event-key-format: '{AccessControlRuleAction}'
  event-key-mapping:
    Allow:
      annotate:
        Stream: WEBFILTER
        Action: URL_ALLOWED
        Status: PASSED
      translate:
        SrcIP: SrcIP
        DstIP: DstIP
        SrcPort: SrcPort
        DstPort: DstPort
        UserName: User
        InitiatorBytes: TXLen
        ResponderBytes: RXLen
        UserAgent: UserAgent
        HTTPResponse: ReturnCode
        ReferencedHost: Domain
        URL: URL 
        Protocol: Proto
    Block:
      annotate:
        Stream: WEBFILTER
        Action: URL_BLOCKED
        Status: FAILED
      translate:
        SrcIP: SrcIP
        DstIP: DstIP
        SrcPort: SrcPort
        DstPort: DstPort
        UserName: User
        InitiatorBytes: TXLen
        ResponderBytes: RXLen
        URL: URL
        WebApplication: App
        Protocol: Proto
    Block with reset:   
      annotate:
        Stream: WEBFILTER
        Action: URL_BLOCKED
        Status: FAILED
      translate: 
        UserName: User
        SrcIP: SrcIP
        DstIP: DstIP
        SrcPort: SrcPort
        DstPort: DstPort
        InitiatorBytes: TXLen
        ResponderBytes: RXLen
        URL: URL
        WebApplication: App
        Protocol: Proto

  fallback:
    annotate:
      EventName: Generic CISCO-FIREPOWER Event
      Stream: OTHER
          

#  globals:
#    translate:
#      Protocol: Proto
       
