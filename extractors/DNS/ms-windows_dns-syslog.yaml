schema-version: 1.0
#extractor-version: 1
extractor-id: 110
source-name: WIN-DNS
source-type: DNS
source-description: Extractor for Windows DNS
provides-streams:
- DNS
master-filters:
- '\w+\s+\d+\s+\d+\:\d+\:\d+\s+\S+\s+.*?\d+.*?\s+PACKET\s+\S+\s+\w+\s+\w{3}\s+'
event-details:
- first-match: '\s+PACKET\s+\S+\s+\w+\s+\w{3}\s+'
  decoder: regex
  decoder-regex: '(?P<datetime>\d+\-\d+\-\d+\s+\d+\:\d+\:\d+|\d{1,2}\/\d{1,2}\/\d{4}\s+\d+\:\d+\:\d+)\s+\w+.*?PACKET\s+\S+\s+(?P<protocol>\S+)\s+\S+\s+(?P<src>[\d\.]+).*?\[\d+(?:\s+\w+)?\s+(?P<flag>\w+)(?:\](?:\s+(?P<lookup>\S+))?(?:\s+.*?\)(?P<domain>\S+)\()?(?:\s+(\(0\)))?)?'
  event-key-format: ''
  event-key-mapping:
    '':
      annotate:
        Stream: DNS
      translate:
        protocol: Proto
        src: SrcIP
        lookup: Lookup
        domain: Domain                  

  fallback:
    annotate:
      EventName: Generic Windows DNS Event
      Stream: OTHER
    translate:
      datetime: SystemTstamp

  globals:
    translate:
      datetime: SystemTstamp
      flag: Action