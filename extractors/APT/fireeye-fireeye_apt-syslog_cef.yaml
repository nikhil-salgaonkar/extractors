schema-version: 1.0
#extractor-version: 1
extractor-id: 96
integration: Syslog(CEF)
vendor-name: Fireeye Inc.
product-name: Fireeye APT
source-name: FIREEYE
source-type: APT
source-description: Extractor for Fireeye APT
provides-streams:
- THREAT
master-filters:
- 'CEF\:0\|(?:FireEye|fireeye)\|'
event-details:
- first-match: 'CEF\:0\|(?:FireEye|fireeye)\|'
  decoder: custom
  decoder-regex: '([\w]+)\=([^\s]+)'
  event-key-format: '{Header-5}'
  decoder-header: CEF
  event-key-mapping:
    'web-infection':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'domain-match':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'ExD Hit Found':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        cs4: Process
    'infection-match':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'Malware Hit Found':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        cs4: Process
    'Malware Scan':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'malware-object':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'malware-callback':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'riskware-callback':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'riskware-infection':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'riskware-object':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'ips-event':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'malicious email':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'FireEye Acquisition Completed':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'FireEye Acquisition Queued':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'IOC Hit Found':           
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate: 
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs4: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'FireEye Acquisition Failed':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'FireEye Acquisition Started':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'FireEye Quarantine Completed':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process
    'FireEye Quarantine Failed':
      annotate:
        Stream: THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Vector: HOST
      translate:
        src: SrcIP
        cmdline: CommandLine
        suser: User
        cs1: Threat
        fname: File
        dst: DstIP
        request: URL
        Process: Process

  fallback:
    annotate:
      EventName: Generic Fireeye Event
      Stream: OTHER

  globals:
    translate:
      rt: SystemTstamp
      dvchost: System