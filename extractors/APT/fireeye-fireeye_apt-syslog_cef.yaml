schema-version: 1.0
#extractor-version: 1
extractor-id: 96
source-name: FIREEYE
source-type: APT
source-description: Extractor for Fireeye APT Events
provides-streams:
- NETWORK-THREAT
master-filters:
- CEF\:0\|(FireEye|fireeye)\|
event-details:
- first-match: act\=(?:blocked|notified)
  decoder: custom
  decoder-regex: ([\w]+)\=([^\s]*)
  event-key-format: '{act}'
  decoder-header: CEF
  event-key-mapping:
    blocked:
      annotate:
        Stream: NETWORK-THREAT
        Action: THREAT_BLOCKED
        Status: PASSED
        Blocked: 'YES'
      translate:
        src: SrcIP
        cs1: AtkMsg
        spt: SrcPort
        shost: SrcHost
        proto: Proto
        dst: DstIP
        Header-5: Signature
        Header-6: Severity
    notified:           
      annotate:
        Stream: NETWORK-THREAT
        Action: THREAT_DETECTED
        Status: PASSED
        Blocked: 'NO'
      translate: 
        src: SrcIP
        cs1: AtkMsg
        spt: SrcPort
        shost: SrcHost
        proto: Proto
        dst: DstIP
        suser: SrcUser
        filePath: FilePath
        Header-5: Signature
        Header-6: Severity
        
  fallback:
    annotate:
      EventName: Generic Fireeye Event
      Stream: OTHER

  globals:
    translate:
      rt: SystemTstamp 

  subs: &id001
    Severity:
      '0': 'LOW'
      '1': 'LOW'
      '2': 'LOW'
      '3': 'LOW'
      '4': 'LOW'
      '5': 'MEDIUM'
      '6': 'MEDIUM'
      '7': 'MEDIUM'
      '8': 'HIGH'
      '9': 'HIGH'
      '10': 'HIGH'
