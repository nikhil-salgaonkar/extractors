schema-version: 1.0
#extractor-version: 1
extractor-id: 164
source-name: HP-OFFICE-CONNECT
source-type: SWITCH
source-description: Extractor for HP Office Connect Events
provides-streams:
- CONNECTIVITY
master-filters:
- \w+\s+\d+\s+\d+\:\d+\:\d+\s+.*?\s+TRAPMGR\[\w+\]\:\s+\S+\(\d+\)
event-details:
- first-match: TRAPMGR\[\w+\]\:\s+
  decoder: regex
  decoder-regex: (?P<datetime>\w+\s+\d+\s+\d+\:\d+\:\d+)\s+(?P<system_name>.*?)\s+(?P<app>TRAPMGR)\[(?P<process>.*?)\]\:\s+(?P<message>.*?\((?P<pid>\d+)\)\s+.*?(?:Link\s+(?P<dev_state>\w+))?\:.*)
  event-key-format: '{dev_state}'
  event-key-mapping:
    'Up':
      annotate:
        Stream: CONNECTIVITY
        Action: LINK_UP
        Status: PASSED
      translate:
        app: App
    'Down':
      annotate:
        Stream: CONNECTIVITY
        Action: LINK_DOWN
        Status: PASSED
      translate:
        app: App

  fallback:
    annotate:
      EventName: Generic HP Office Connect Event
      Stream: OTHER

  globals:
    translate:
      datetime: SystemTstamp
      system_name: System