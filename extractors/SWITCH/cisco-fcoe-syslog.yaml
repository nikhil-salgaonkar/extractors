schema-version: 1.0
#extractor-version: 1
extractor-id: 185
source-name: FCOE-SWITCH
source-type: SWITCH
source-description: extractor for FCoE Switch Events
provides-streams:
- AUTHENTICATION
master-filters:
- '\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2}\s+\d{4}\s+\S+\s+.*?10\w+\/\d+\/.*?\(\w+\)\:'
event-details:
- first-match: 'SSH\/\d+\/(?:SSH\_AUTH\_TIMEOUT|SSH_LOGIN|SSH_CONNECTION_CLOSE)\(\w+\)\:\s+'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})\s+\d+\s+(?P<hostname>\S+)\s+.*?10(?P<facility>\w+)\/(?P<severity>\d+)\/(?P<action>\w+)\(.*?\:\s+(?P<message>.*?user\s+(?P<user>.*?)\s+\(IP\:\s+(?P<src>[\d+\.]+)\)\s+.*)'
  event-key-format: '{action}'
  event-key-mapping:
    'SSH_LOGIN':           
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
        AuthMethod: SSH
        Reason: '-'
      translate: 
        user: User
        src: SrcIP

    'SSH_CONNECTION_CLOSE':           
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED
        AuthMethod: SSH
      translate: 
        user: User
        src: SrcIP
    
  fallback:
    annotate:
      EventName: Generic FCoE Switch Event
      Stream: OTHER  

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System 

- first-match: 'SHELL\/\d+\/LOGOUT\(\w+\)\:\s+'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})\s+\d+\s+(?P<hostname>\S+)\s+.*?10(?P<facility>\w+)\/(?P<severity>\d+)\/(?P<action>\w+)\(.*?\:\s+.*?\:(?P<message>(?P<user>.*?)\s+.*)'
  event-key-format: '{action}'
  event-key-mapping:
    'LOGOUT':           
      annotate:
        Stream: AUTHENTICATION
        Action: LOGOUT
        Status: PASSED
        AuthMethod: '-'
      translate:
        user: User
        src: SrcIP

    
  fallback:
    annotate:
      EventName: Generic FCoE Switch Event
      Stream: OTHER  

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System  

- first-match: 'SHELL\/\d+\/SHELL\_LOGINFAIL\(\w+\)\:\s+'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})\s+\d+\s+(?P<hostname>\S+)\s+.*?10(?P<facility>\w+)\/(?P<severity>\d+)\/(?P<action>\w+)\(.*?\:\s+(?P<message>.*?user\s+(?P<user>.*?)\s+.*?from\s+(?P<src>[\d+\.]+).*)'
  event-key-format: '{action}'
  event-key-mapping:
    'SHELL_LOGINFAIL':           
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: FAILED
        AuthMethod: SSH
        Reason: 'INVALID_PASSWORD'
      translate: 
        user: User
        src: SrcIP
    
  fallback:
    annotate:
      EventName: Generic FCoE Switch Event
      Stream: OTHER  

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System 

- first-match: 'SHELL\/\d+\/SHELL\_LOGIN\(\w+\)\:\s+'
  decoder: regex
  decoder-regex: '(?P<datetime>\w{3}\s+\d{1,2}\s+\d{2}\:\d{2}\:\d{2})\s+\d+\s+(?P<hostname>\S+)\s+.*?10(?P<facility>\w+)\/(?P<severity>\d+)\/(?P<action>\w+)\(.*?\:\s+(?P<message>(?P<user>.*?)\s+.*?from\s+(?P<src>[\d\.]+))\.'
  event-key-format: '{action}'
  event-key-mapping:
    'SHELL_LOGIN':           
      annotate:
        Stream: AUTHENTICATION
        Action: LOGIN
        Status: PASSED
        AuthMethod: SSH
        Reason: '-'
      translate: 
        user: User
        src: SrcIP
    
  fallback:
    annotate:
      EventName: Generic FCoE Switch Event
      Stream: OTHER  

  globals:
    translate:
      datetime: SystemTstamp
      hostname: System                   

